<UserControl
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	mc:Ignorable="d"
	x:Class="Waveface.Client.PhotoViewerControl"
    xmlns:l="clr-namespace:Waveface.Client"
	x:Name="UserControl"
	Loaded="WindowLoaded"
	d:DesignWidth="760" d:DesignHeight="504">
    <UserControl.Resources>
        <ItemsPanelTemplate x:Key="ItemsPanelTemplate1">
            <VirtualizingStackPanel IsItemsHost="True" Orientation="Horizontal"/>
        </ItemsPanelTemplate>

        <Style x:Key="ListBoxItemStyle" TargetType="{x:Type ListBoxItem}">
            <!--<Setter Property="Background" Value="Transparent"/>-->
            <!--<Setter Property="Padding" Value="2,0,0,0"/>-->
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                        <Border  x:Name="Bd" SnapsToDevicePixels="true"  Background="#EEFFFFFF" BorderBrush="#FFCCCCCC"  RenderTransformOrigin="1,1" 
							HorizontalAlignment="Center" VerticalAlignment="Center"
							BorderThickness="1" Opacity="70">
                                <Image x:Name="img" ToolTipService.Placement="Top"
									Source="{Binding ThumbnailSource, IsAsync=True}" Height="64" Stretch="Fill" Width="64"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Storyboard x:Key="ShowAllContent">
        	<ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="lbImages">
        		<DiscreteObjectKeyFrame KeyTime="0:0:0.4" Value="{x:Static Visibility.Visible}"/>
        	</ObjectAnimationUsingKeyFrames>
        	<ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="label">
        		<DiscreteObjectKeyFrame KeyTime="0:0:0.4" Value="{x:Static Visibility.Collapsed}"/>
        	</ObjectAnimationUsingKeyFrames>
        </Storyboard>
    </UserControl.Resources>
	<UserControl.Triggers>
		<EventTrigger RoutedEvent="Mouse.MouseEnter" SourceName="label">
			<BeginStoryboard x:Name="ShowAllContent_BeginStoryboard" Storyboard="{StaticResource ShowAllContent}"/>
		</EventTrigger>
		<EventTrigger RoutedEvent="Mouse.MouseLeave" SourceName="lbImages">
			<RemoveStoryboard BeginStoryboardName="ShowAllContent_BeginStoryboard"/>
		</EventTrigger>
	</UserControl.Triggers>

    <Grid x:Name="LayoutRoot">
        <!-- Photo -->
        <Viewbox Stretch="Fill" DockPanel.Dock="Top">
            <Canvas x:Name="ImgCanvas" ClipToBounds="True" Height="371" Width="602">
                <ContentControl x:Name="ImgContentCtrl" Height="371" Width="602" Canvas.Left="0" Canvas.Top="1">
                    <Grid x:Name="ImgGrid">
                        <Image x:Name="ImgObject" Source="{Binding SelectedItem.ImageSource, IsAsync=True, ElementName=lbImages}"/>
                        <Thumb x:Name="ImgThumb" Opacity="0" DragDelta="ImgThumb_DragDelta" MouseWheel="ImgThumb_MouseWheel"/>
                    </Grid>
                </ContentControl>
            </Canvas>
        </Viewbox>
		<Label x:Name="label" VerticalAlignment="Bottom" Height="20" Opacity="0"/>
        <ListBox x:Name="lbImages" Background="{x:Null}" BorderBrush="{x:Null}" Opacity="70" 
                    IsSynchronizedWithCurrentItem="True"
					ItemsPanel="{DynamicResource ItemsPanelTemplate1}" 
					ItemContainerStyle="{DynamicResource ListBoxItemStyle}" 
                    SelectionMode="Extended"
					ItemsSource="{Binding}" 
					VerticalAlignment="Bottom"
                    VirtualizingStackPanel.IsVirtualizing="True" 
                    VirtualizingStackPanel.VirtualizationMode="Recycling" 
                    Visibility="Collapsed"/>
    </Grid>
</UserControl>